from groq import Groq


def summarize_text(input_text):
    """
    Sends a Hebrew conversation to the Groq API for summarization and returns the summary.

    Args:
        input_text (str): The conversation text in Hebrew to be summarized.

    Returns:
        str: The summary provided by the Groq API.
    """
    client = Groq(api_key='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')

    # Prepare the request
    completion = client.chat.completions.create(
        model="llama3-8b-8192",
        messages=[
            {
                "role": "system",
                "content": (
                    "You are a summarization expert. Given a conversation in Hebrew, provide a concise summary "
                    "of the text in Hebrew, using no more than 50 words. The summary should encapsulate the "
                    "essence of the conversation in a single paragraph."
                ),
            },
            {"role": "user", "content": input_text},
        ],
        temperature=1,
        max_tokens=1024,
        top_p=1,
        stream=True,
        stop=None,
    )

    # Collect the response
    summary = ""
    for chunk in completion:
        if chunk.choices[0].delta.content:
            summary += chunk.choices[0].delta.content

    return summary

# Example usage
if __name__ == "__main__":
    input_text = (
        """
        "content": "You are a summarization expert. Given a conversation in Hebrew, provide a concise summary of the text in Hebrew, using no more than 50 words. The summary should encapsulate the essence of the conversation in a single paragraph. \n\n\n\n\ninput:\" די נידארנו (050-1234567):\n  \"הי, חברים. המצב לא פשוט. הלקוחות שמתחילים לקבל את אישורי ההטמנה שואלים שאלות. הם לא רגילים למקרים כאלה, וזה מתחיל להיראות חשוד. אבו עלי, מה קורה עם העברות הכספים?\"\n  \n  אבו עלי אקספרס (050-2345678):\n  \"אני כבר מתחיל לאסוף את הצ'יקים, הכל מתואם עם פישיפח. השאלות מגיעות בעיקר בגלל שהסכומים לא כל כך מסתדרים עם שאר החשבוניות. חייבים למצוא דרך להסתיר את המקורות.\"\n  \n  דקה קומוסטס (050-3456789):\n  \"אני יודע. אז אני משדרג את השיטות בינתיים עם בי אס טורנדו וביגשי. צריך לדאוג שהכסף יעבור דרך החברה הפרטית ב'בי אס טורנדו', ואז להמיר את הצ'יקים ב'ביגשי'. אם לא נעשה את זה, יתחילו לחפור.\"\n  \n  די נידארנו:\n  \"נכון, אנחנו לא רוצים למשוך תשומת לב. אם יתחילו לשאול שאלות על פישיפח ו'קישקיש', זה יכול להיות הסוף של העסק הזה.\"\n  \n  אבו עלי אקספרס:\n  \"אני אשלח את הצ'יקים לפישיפח, ואנחנו נעשה את כל המעברים דרך 'קישקיש' ו'בוקי סרקי', זה כבר מזמן לא מעניין אף אחד. אבל די נידארנו, אתה בטח יודע שהלקוחות לא יכולים לדעת מה קורה באמת. אז צריך להראות להם שההטמנות היו חוקיות ושהם קיבלו בדיוק את מה שהם שילמו עליו.\"\n  \n  דקה קומוסטס:\n  \"אתם צודקים, המטרה היא לא למשוך תשומת לב. בינתיים, אני מתחיל לסדר את החשבוניות שמגיעות מ'פינוי ודישדוש' ו'עפר סולו'. אם מישהו יבדוק את כל השמות שמגיעים משם, הם יראו שהכול בסדר.\"\n  \n  די נידארנו:\n  \"ואנחנו לא שוכחים את 'הירוק' ו'הכחול', נכון? הם יכולים להפעיל את הלחץ על החברה לפינוי פסולת ולחפירות עפר, ככה זה ייראה יותר טבעי.\"\n  \n  אבו עלי אקספרס:\n  \"כן, בדיוק. נוודא שלא ייווצר קשר ישיר בין השמות של החברות הקש וההעברות. אני מקווה שזה יעבוד, כי אם לא, יש לנו בעיה.\"\n  \n  דקה קומוסטס:\n  \"אני לא לוקח סיכון, אני אתעקש על כמה שיותר צ'קים גדולים מ'קושקוש כלום ושום דבר', כדי שזה לא ייראה חשוד.\"\n  \n  די נידארנו:\n  \"מעולה. אז קדימה, נעבוד בצורה שקטה. כל הצ'יקים צריכים לעבור דרך התהליך הזה – מעסק לעסק – ואז נוכל להוציא את הכסף הלאה. נשאר רק לוודא שהכספים שהעברנו בפיצול לא יתפסו על ידי הרשויות.\"\n  \n  אבו עלי אקספרס:\n  \"אני מתחיל להעביר את הצ'יקים הבאים לכיוון 'פישיפח' ו'קישקיש'. הצ'קים של 'קושקוש' בדרך.\"\n  \n  דקה קומוסטס:\n  \"מעולה. אני אעדכן אתכם כל הזמן. אנחנו לא רוצים שום טעויות, הסכום הזה חייב לעבור חלק.\"\n  \n  די נידארנו:\n  \"מצוין. חברים, אם מישהו שואל שאלות, תדאגו לתשובות טובות. אני לא רוצה שתהיה לנו בעיה עם החברות הנורמטיביות. לא שווה לנו להסתבך על שטויות.\"\n  \n  אבו עלי אקספרס:\n  \"ברור. רק לא לשכוח את הלקוח מ'הירוק' שמרוצה מהפינוי.\"  די נידארנו (050-1234567):\n  \"הי, חברים. המצב לא פשוט. הלקוחות שמתחילים לקבל את אישורי ההטמנה שואלים שאלות. הם לא רגילים למקרים כאלה, וזה מתחיל להיראות חשוד. אבו עלי, מה קורה עם העברות הכספים?\"\n  \n  אבו עלי אקספרס (050-2345678):\n  \"אני כבר מתחיל לאסוף את הצ'יקים, הכל מתואם עם פישיפח. השאלות מגיעות בעיקר בגלל שהסכומים לא כל כך מסתדרים עם שאר החשבוניות. חייבים למצוא דרך להסתיר את המקורות.\"\n  \n  דקה קומוסטס (050-3456789):\n  \"אני יודע. אז אני משדרג את השיטות בינתיים עם בי אס טורנדו וביגשי. צריך לדאוג שהכסף יעבור דרך החברה הפרטית ב'בי אס טורנדו', ואז להמיר את הצ'יקים ב'ביגשי'. אם לא נעשה את זה, יתחילו לחפור.\"\n  \n  די נידארנו:\n  \"נכון, אנחנו לא רוצים למשוך תשומת לב. אם יתחילו לשאול שאלות על פישיפח ו'קישקיש', זה יכול להיות הסוף של העסק הזה.\"\n  \n  אבו עלי אקספרס:\n  \"אני אשלח את הצ'יקים לפישיפח, ואנחנו נעשה את כל המעברים דרך 'קישקיש' ו'בוקי סרקי', זה כבר מזמן לא מעניין אף אחד. אבל די נידארנו, אתה בטח יודע שהלקוחות לא יכולים לדעת מה קורה באמת. אז צריך להראות להם שההטמנות היו חוקיות ושהם קיבלו בדיוק את מה שהם שילמו עליו.\"\n  \n  דקה קומוסטס:\n  \"אתם צודקים, המטרה היא לא למשוך תשומת לב. בינתיים, אני מתחיל לסדר את החשבוניות שמגיעות מ'פינוי ודישדוש' ו'עפר סולו'. אם מישהו יבדוק את כל השמות שמגיעים משם, הם יראו שהכול בסדר.\"\n  \n  די נידארנו:\n  \"ואנחנו לא שוכחים את 'הירוק' ו'הכחול', נכון? הם יכולים להפעיל את הלחץ על החברה לפינוי פסולת ולחפירות עפר, ככה זה ייראה יותר טבעי.\"\n  \n  אבו עלי אקספרס:\n  \"כן, בדיוק. נוודא שלא ייווצר
        קשר ישיר בין השמות של החברות הקש וההעברות. אני מקווה שזה יעבוד, כי אם לא, יש לנו בעיה.\"\n  \n  דקה קומוסטס:\n  \"אני לא לוקח סיכון, אני אתעקש על כמה שיותר צ'קים גדולים מ'קושקוש כלום ושום דבר', כדי שזה לא ייראה חשוד.\"\n  \n  די נידארנו:\"מעולה. אז קדימה, נעבוד בצורה שקטה. כל הצ'יקים צריכים לעבור דרך התהליך הזה – מעסק לעסק – ואז נוכל להוציא את הכסף הלאה. נשאר רק לוודא שהכספים שהעברנו בפיצול לא יתפסו על ידי הרשויות.\"\n  \n  אבו עלי אקספרס:\n  \"אני מתחיל להעביר את הצ'יקים הבאים לכיוון 'פישיפח' ו'קישקיש'. הצ'קים של 'קושקוש' בדרך.\"\n  \n  דקה קומוסטס:\n  \"מעולה. אני אעדכן אתכם כל הזמן. אנחנו לא רוצים שום טעויות, הסכום הזה חייב לעבור חלק.\"\n  \n  די נידארנו:\n  \"מצוין. חברים, אם מישהו שואל שאלות, תדאגו לתשובות טובות. אני לא רוצה שתהיה לנו בעיה עם החברות הנורמטיביות. לא שווה לנו להסתבך על שטויות.\"\n  \n  אבו עלי אקספרס:\n  \"ברור. רק לא לשכוח את הלקוח מ'הירוק' שמרוצה מהפינוי.\"\"\n\noutput: קבוצת אנשים דנה בדרכים להסתיר מקור כספים חשוד באמצעות העברות בין חברות קש, תיאום צ'קים ושימוש במסמכים מזויפים כדי להיראות חוקיים. המטרה: למנוע תשומת לב מיותרת מצד הרשויות והלקוחות, תוך ניהול הסיכונים ומענה על שאלות העלולות לעורר חשדות."
        },
        {
            "role": "user",
            "content": "יעל (050-1234567):\n\"היי, חברה, אני חושבת שצריך להתחיל להתארגן לפיקניק בשבת. מה דעתכם?\"\n\nדני (050-2345678):\n\"נשמע רעיון מעולה! אני יכול להביא מחצלת וכמה כדורים למשחקים.\"\n\nעדי (050-3456789):\n\"מעולה! אני אביא סלטים וקצת פירות. יעל, תביאי שתייה?\"\n\nיעל:\n\"בכיף, אני אביא שתייה קרה וכמה כוסות חד-פעמיות.\"\n\nדני:\n\"מעולה. צריך גם לדאוג למוזיקה, אני אביא רמקול בלוטות'. מה לגבי שעה?\"\n\nעדי:\n\"נפגש בעשר בבוקר בפארק המרכזי?\"\n\nיעל:\n\"מצוין! אני אשלח הודעה בקבוצה כדי שכולם יידעו.\""
        """
    )

    summary = summarize_text(input_text)
    print("Summary:", summary)
